import React from 'react'
import { Prism as SyntaxHighlighter } from 'react-syntax-highlighter';
import { Box, LegacyCard, Text, VerticalStack } from '@shopify/polaris';
import { coy } from 'react-syntax-highlighter/dist/esm/styles/prism';
import func from '@/util/func';
import transform from '../../../components/shared/customDiffEditor';

const HttpRequestResponseViewer = ({ data }) => {
  const requestJsonObj = func.requestJson(data, [])
  const responseJsonObj = func.responseJson(data, [])

  const formattedRequest = transform.formatData(requestJsonObj,"http")
  const formattedResponse = transform.formatData(responseJsonObj,"http")
  
  return (
    <VerticalStack gap={3}>
        <Box>
            <LegacyCard>
                <Box padding={3} borderRadius='2'>
                    <Text>Request</Text>
                    <Box style={{maxHeight: '500px', overflowY: 'scroll'}} overflowY='scroll'>
                      <SyntaxHighlighter lineProps={{style: {whiteSpace: 'pre-wrap'}}} wrapLongLines={true} showLineNumbers={true} language="http" style={coy}>
                          {formattedRequest}
                      </SyntaxHighlighter>
                    </Box>
                </Box>
            </LegacyCard>
        </Box>

        <Box>
            <LegacyCard>
                <Box padding={3} borderRadius='2'>
                    <Text>Response</Text>
                    <Box style={{maxHeight: '500px', overflowY: 'scroll'}} overflowY='scroll'>
                      <SyntaxHighlighter lineProps={{style: {whiteSpace: 'pre-wrap'}}} wrapLongLines={true} showLineNumbers={true} language="http" style={coy}>
                          {formattedResponse}
                      </SyntaxHighlighter>
                    </Box>
                </Box>
            </LegacyCard>
        </Box>
    </VerticalStack>
  )
}

export default HttpRequestResponseViewer
